{% set pathBase='inamika_backoffice_projects' %} 
{% extends "InamikaBackOfficeBundle::layout.html.twig" %}
{% block body %} 
{{ parent()}}     
{{ form_start(form, {'attr': {'class': 'form-material sendToApi','novalidate':'novalidate'} }) }}
    <div class="form-body">
        <h3 class="card-title cursor-pointer" data-toggle="collapse" data-target="#collapseGeneral" aria-expanded="false" aria-controls="collapseGeneral">{{ 'GENERAL_DATA' | trans }}</h3>
        <hr>
        <div class="collapse show" id="collapseGeneral">
            <div class="row p-t-20">
                <div class="col-md-6 col-lg-4">
                    <div class="form-group">
                        {{form_label(form.projectType)}}
                        {{form_widget(form.projectType)}}
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="form-group">
                        {{form_label(form.name)}}
                        {{form_widget(form.name)}}
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="form-group">
                        {{form_label(form.isActive)}}
                        {{form_widget(form.isActive)}}
                    </div>
                </div>
                <div class="col-md-12">
                    <div class="form-group">
                        {{form_label(form.description)}}
                        {{form_widget(form.description)}}
                    </div>
                </div>
            </div>
        </div>
        <h3 class="card-title cursor-pointer" data-toggle="collapse" data-target="#collapseMap" aria-expanded="false" aria-controls="collapseMap">{{ 'MAP_OR_IMPLANTATION' | trans }}</h3>
        <hr>
        <div class="collapse" id="collapseMap">
            <div class="row">
                <div class="col-md-12">
                    <div class="form-group">
                        {% if entity is defined and entity.map %}
                            {{form_widget(form.map,{ attr: { 'data-default-file': web_image('uploads/or/' ~ entity.map).resize('','480') }})}}
                        {% else %}
                            {{form_widget(form.map)}}
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        {% include 'InamikaBackOfficeBundle:_partials:files.html.twig' %}
    </div>
    <div class="form-actions">
        <button type="submit" class="btn btn-success"> <i class="fa fa-check"></i> {{ 'SAVE' | trans }}</button>
        <button type="button" class="btn btn-inverse" onclick="location.href='{{ path(pathBase) }}'">{{ 'CANCEL' | trans }}</button>
    </div>
{{ form_end(form) }}
{% endblock body %}
{% block javascripts %} 
{{ parent() }}
{% include 'InamikaBackOfficeBundle:_partials:dropifyScripts.html.twig' %}
<script>
    $(function (){
        {% if entity is defined %}
            {% for gallery in entity.gallery %}
                {% if gallery.type == 'image' %}
                    gallery.push({
                        id:'{{ gallery.id}}',
                        type: '{{ gallery.type}}', 
                        data: '{{ asset('uploads/sm/') }}{{ gallery.value}}'
                    });
                {% else %}
                    gallery.push({
                        id:'{{ gallery.id}}',
                        type: '{{ gallery.type}}', 
                        data: '{{ gallery.value}}'
                    });
                {% endif %}
                renderGallery();
            {% endfor %}
        {% endif %}
    });
    function beforeSuccess(){
        location.href="{{ path(pathBase) }}";
    }
</script>
{% endblock javascripts %}
